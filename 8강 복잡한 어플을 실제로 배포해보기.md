### ì„¹ì…˜ ì„¤ëª…

-   6, 7ê°• ì„¹ì…˜ì—ì„œ ë„ì»¤ë¥¼ ì´ìš©í•˜ì—¬ ë¦¬ì•¡íŠ¸ ì•±ì„ ë§Œë“¤ì–´ë´¤ë‹¤.

-   í•˜ì§€ë§Œ ì‹¤ì œë¡œ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ë§Œë“¤ë•ŒëŠ” í”„ë¡ íŠ¸ ë¶€ë¶„ë§Œì„ ì´ìš©í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ ë°±ì—”ë“œ ì„œë²„ë„ í•„ìš”í•˜ê³  ë°ì´í„°ë² ì´ìŠ¤ ë“± ë§ì€ ê²ƒì´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— ì´ë²ˆ ì„¹ì…˜ë¶€í„°ëŠ” ì¢€ ë” ë§ì€ ì»¨í…Œì´ë„ˆë¥¼ ì‚¬ìš©í•´ì„œ ì¢€ ë” ì‹¤ë¬´ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ë§Œë“¤ì–´ë³´ì.

ğŸ“ ì—¬ëŸ¬ê°œì˜ ì»¨í…Œì´ë„ˆë¥¼ ì´ìš©í•´ êµ¬í˜„í•  ì–´í”Œë¦¬ì¼€ì´ì…˜ì€?

-   í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì•„ë¬´ê¸€ì´ë‚˜ ì…ë ¥ì„ í•˜ë©´ ë¦¬ì•¡íŠ¸ë¥¼ í†µí•´ì„œ ë…¸ë“œë¡œ ì „ë‹¬ ëœ ì´í›„ Mysql ë°ì´í„° ë² ì´ìŠ¤ì— ì €ì¥í•œ í›„ ì €ì¥ ëœ ê²ƒì„ í™”ë©´ì— ë³´ì—¬ì£¼ëŠ” ì•±ì„ êµ¬í˜„í•  ê²ƒì´ë‹¤.

-   ê·¸ë¦¬ê³  ì»¨í…Œì´ë„ˆë¥¼ ì‚­ì œ í–ˆë‹¤ê°€ ë‹¤ì‹œ ìƒì„±í•´ë„ DBì— ì €ì¥ëœ ë°ì´í„°ëŠ” ë‚¨ì•„ìˆê²Œ í•´ì¤„ ê²ƒì´ë‹¤.

ğŸ“Œ Multi Container ì•±ì„ ìœ„í•œ ì „ì²´ì ì¸ ì„¤ê³„

-   ë‘ê°€ì§€ ë°©ë²•

1.    Nginxë¡œ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì˜¤ëŠ” ìš”ì²­ì„ ë°±ì—”ë“œ ì„œë²„ì™€ í”„ë¡ íŠ¸ ì„œë²„ë¡œ ë‚˜ëˆ ì£¼ëŠ” êµ¬ì¡°.
   
              
    âœ” ì¥ì 

    -  ìš”ì²­ì„ ë³´ë‚¼ ë•Œ URL ë¶€ë¶„ì„ hostì´ë¦„ì´ ë°”ë€Œì–´ë„ ë³€ê²½í•˜ì§€ ì•Šì•„ë„ ëœë‹¤

    -   í¬íŠ¸ê°€ ë°”ë€Œì–´ë„ ë³€ê²½í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.

    ex) axios.get("api/valuse")

    âœ” ë‹¨ì 

    -  nginx ì„¤ì •, ì „ì²´ ì„¤ê³„ê°€ ë³µì¡í•˜ë‹¤


2.   NginxëŠ” í”„ë¡ íŠ¸ ì„œë²„ë¡œë§Œ ì‚¬ìš©í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì •ì  íŒŒì¼ì„ ìš”êµ¬í•  ë•Œ ì œê³µí•´ì£¼ëŠ” í˜•ì‹ìœ¼ë¡œë§Œ ì“°ì´ëŠ” êµ¬ì¡°

    âœ” ì¥ì 

     -  ì„¤ê³„ê°€ ë‹¤ì†Œ ê°„ë‹¨í•˜ì—¬ êµ¬í˜„í•˜ëŠ”ê²Œ ë” ì‰½ë‹¤

    ex) axios.get("http://localhost:3000/api/valuse")

    âœ” ë‹¨ì 

     -  hostì´ë¦„ì´ë‚˜ í¬íŠ¸ ë³€ê²½ì´ ìˆìœ¼ë©´ ìš”ì²­ URLë„ ë³€ê²½í•´ì•¼ í•œë‹¤.

-   ë³µì¡í•œ ìª½ìœ¼ë¡œ êµ¬í˜„ì„ ì‹œì‘í•´ë³´ì!

ğŸ‘€ ì „ì²´ì ì¸ íë¦„

  `ì „ì²´ ì†ŒìŠ¤ ì½”ë“œ ì‘ì„± => Dockerfile ì‘ì„± => docker-compose ì‘ì„±` (8ê°•)


-   ì „ì²´ ì†ŒìŠ¤ ì½”ë“œ ì‘ì„±

        -  NodeJs => React

-   Dockerfile ì‘ì„±

    -   ê°œë°œí™˜ê²½(Dockerfile.dev)
        
        -   Front => Server  => Mysql => Nginx 

    -   ìš´ì˜í™˜ê²½(Dockerfile)

        -   Front => Server  => Mysql => Nginx 

-   docker-compose ì‘ì„±

```js
version

services
    
    frontend

    backend

    nginx

    mysql

```
`ê¹ƒí—™ì— Push => Travis CI => Docker Hub => AWS ElasticBeanStalk` (9ê°•)

-   ê¹ƒí—™ì— Push
    
    - Feature Branch => Master Branch

-   Travis CI

    -   í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‹¤í–‰ => í…ŒìŠ¤íŠ¸ ì„±ê³µ => ê°ê°ì˜ Dockerfileì„ ì´ìš©í•˜ì—¬ Imageë¥¼ ìƒì„±(ë¹Œë“œ) => ì´ë¯¸ì§€ ìƒì„± í›„ Docker Hubë¡œ ì „ë‹¬

-   Docker Hub

    -  Travis CIì—ì„œ ë¹Œë“œëœ ì´ë¯¸ì§€ë¥¼ ë³´ê´€

    -   AWS ElasticBeanStalkì—ì„œ ê°€ì ¸ê°€ë ¤ê³  í•  ë•Œ ì „ë‹¬

-   AWS ElasticBeanStalk

    -   Travis CIì—ì„œ ë¹Œë“œëœ ì´ë¯¸ì§€ë¥¼ ì´ìš©í•´ì„œ ë°°í¬

### ë¦¬ì•¡íŠ¸ ì•±ì„ ìœ„í•œ ë„ì»¤ íŒŒì¼ ë§Œë“¤ê¸°

-   ì‘ì„±í•œ ì†ŒìŠ¤ì½”ë“œë¥¼ ë„ì»¤ í™˜ê²½ì—ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆê²Œ ë„ì™€ì£¼ëŠ” Dockerfileì„ ì‘ì„±í•´ë³´ì.

-   Dockerfileì€ ê°œë°œí™˜ê²½ê³¼ ìš´ì˜í™˜ê²½ì—ì„œ ë‹¤ë¥´ê²Œ êµ¬ì„±í•˜ëŠ” ê²ƒì´ ì¢‹ê¸° ë•Œë¬¸ì— ê°œë°œí™˜ê²½ì„ ìœ„í•œ Dockerfileì„ ë§Œë“¤ê³  ê·¸ í›„ì— ìš´ì˜í™˜ê²½ì„ ìœ„í•œ Dockerfileì„ ë§Œë“¤ì.

âœ” Dockerfile.dev

```js
FROM node:alpine

WORKDIR /app

COPY package.json ./

RUN npm install

COPY ./ ./

CMD ["npm", "run", "start"]
```

âœ” Dockerfile

```js
FROM node:alpine as builder

WORKDIR /app

COPY package.json ./

RUN npm install

COPY ./ ./

RUN npm run build

FROM nginx

EXPOSE 3000

COPY ./nginx/default.conf /etc/nginx/conf.d/default.conf

COPY --from=builder /app/build /usr/share/nginx/html
```
ğŸ“Œ `COPY ./nginx/default.conf /etc/nginx/conf.d/default.conf`

-   default.confì—ì„œ í•´ì¤€ ì„¤ì •ì„ nginx ì„¤ì •ì•ˆì— ìˆëŠ” ì„¤ì •ì´ ë˜ê²Œ ë³µì‚¬í•´ì¤€ë‹¤

âœ” default.conf

```js
server {
    listen 3000;

    location / {
        root /usr/share/nginx/html;

        index index.html index.htm;

        try_files $uri $uri/ /index.html;
    }
}
```

-    listen 3000 : nginx ì„œë²„ê°€

-    root /usr/share/nginx/html; : HTML íŒŒì¼ì´ ìœ„ì¹˜í•  ë£¨íŠ¸ ì„¤ì •

-    index index.html index.htm; : ì‚¬ì´íŠ¸ì˜ index í˜ì´ì§€ë¡œ í•  íŒŒì¼ëª… ì„¤ì •

-   try_files $uri $uri/ /index.html; 

    -   React Routerë¥¼ ì‚¬ìš©í•´ì„œ í˜ì´ì§€ê°„ ì´ë™ì„ í•  ë•Œ ì´ë¶€ë¶„ì´ í•„ìš”í•˜ë‹¤ 

    -   ì¢€ ë” ìì„¸í•œ ì„¤ëª…
        
        - ReactëŠ” SPAì´ë‹¤. ê·¸ëŸ¬ê¸°ì—  index.html í•˜ë‚˜ì˜ ì •ì  íŒŒì¼ë§Œ ê°€ì§€ê³  ìˆì–´ì„œ ë§Œì•½ {URL}/home ì´ë ‡ê²Œ ì ‘ì†ì„ í•˜ë ¤ê³  í• ë•Œë„ index.html íŒŒì¼ì— ì ‘ê·¼ì„ í•´ì„œ ë¼ìš°íŒ…ì„ ì‹œì¼œì•¼ í•˜ëŠ”ë° nginxì—ì„œëŠ” ìë™ìœ¼ë¡œ ì´ê²ƒì„ ì•Œ ìˆ˜ ì—†ë‹¤. ê·¸ëŸ¬ê¸°ì— /homeì— ì ‘ì†í•˜ë ¤ê³  í•  ë•Œ /homeì— ë§¤ì¹­ë˜ëŠ” ê²ƒì´ ì—†ì„ ë–„ì— ëŒ€ì•ˆì±…ìœ¼ë¡œ index.htmlì„ ì œê³µí•˜ì—¬ì„œ /homeìœ¼ë¡œ ë¼ìš°íŒ…ì„ ì‹œí‚¬ ìˆ˜ ìˆê²Œ ì„¤ì •ì„ í•´ì£¼ëŠ” ê²ƒì´ë‹¤.    